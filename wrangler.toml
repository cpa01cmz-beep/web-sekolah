"$schema" = "./node_modules/wrangler/config-schema.json"
name = "website-sekolah"
main = "worker/index.ts"
compatibility_date = "2026-02-18"
compatibility_flags = ["nodejs_compat"]

[assets]
directory = "dist/client"
not_found_handling = "single-page-application"
run_worker_first = ["/api/*", "!/api/docs/*"]

[observability]
enabled = true

[observability.logs]
enabled = true

[[durable_objects.bindings]]
name = "GlobalDurableObject"
class_name = "GlobalDurableObject"

[[migrations]]
tag = "v1"
new_sqlite_classes = ["GlobalDurableObject"]

# Staging Environment
[env.staging]
name = "website-sekolah-staging"
vars = { ENVIRONMENT = "staging" }

[[env.staging.durable_objects.bindings]]
name = "GlobalDurableObject"
class_name = "GlobalDurableObject"

[[env.staging.migrations]]
tag = "v1"
new_sqlite_classes = ["GlobalDurableObject"]

# Production Environment
[env.production]
name = "website-sekolah-production"
keep_vars = true
vars = { ENVIRONMENT = "production" }

[[env.production.durable_objects.bindings]]
name = "GlobalDurableObject"
class_name = "GlobalDurableObject"

[[env.production.migrations]]
tag = "v1"
new_sqlite_classes = ["GlobalDurableObject"]
